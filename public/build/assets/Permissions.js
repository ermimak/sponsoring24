import{k as a,o as d,f as e,y as U,j as x,q as u,v as c,F as _,l as w,t as v,z as D,m,I as h,a as r}from"./vendor.js";import{_ as j}from"./_plugin-vue_export-helper.js";const q={__name:"Permissions",setup(k,{expose:s}){s();const f=m([]),i=m([]),p=m({name:"",label:""}),l=m(null),n=m([]);async function t(){const o=await r.get("/api/permissions");f.value=o.data}async function P(){const o=await r.get("/api/roles");i.value=o.data}h(()=>{t(),P()});async function C(){await r.post("/api/permissions",p.value),p.value={name:"",label:""},t()}function R(o){l.value={...o},n.value=(o.roles||[]).map(b=>b.id)}async function V(){await r.put(`/api/permissions/${l.value.id}`,l.value);for(const o of i.value){const b=n.value.includes(o.id),y=(l.value.roles||[]).some(M=>M.id===o.id);b&&!y?await r.post(`/api/permissions/${l.value.id}/assign-role`,{role_id:o.id}):!b&&y&&await r.post(`/api/permissions/${l.value.id}/remove-role`,{role_id:o.id})}l.value=null,t()}async function S(o){await r.delete(`/api/permissions/${o}`),t()}function I(o){}const g={permissions:f,roles:i,newPermission:p,editingPermission:l,editingPermissionRoleIds:n,fetchPermissions:t,fetchRoles:P,createPermission:C,editPermission:R,updatePermission:V,deletePermission:S,toggleRole:I,ref:m,onMounted:h,get axios(){return r}};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}},A={class:"mb-4"},B={class:"min-w-full bg-white border"},E={class:"border px-4 py-2"},L={class:"border px-4 py-2"},N={class:"border px-4 py-2"},F=["onClick"],z=["onClick"],O={key:0,class:"mt-6 p-4 border rounded bg-gray-50"},T={class:"font-semibold mb-2"},G={class:"mt-4"},H=["value","onChange"],J={class:"ml-1"};function K(k,s,f,i,p,l){return d(),a("div",null,[s[10]||(s[10]=e("h1",{class:"text-2xl font-bold mb-4"},"Permissions Management",-1)),e("div",A,[e("form",{onSubmit:x(i.createPermission,["prevent"])},[u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>i.newPermission.name=n),placeholder:"Permission name",class:"border p-2 mr-2",required:""},null,512),[[c,i.newPermission.name]]),u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>i.newPermission.label=n),placeholder:"Label (optional)",class:"border p-2 mr-2"},null,512),[[c,i.newPermission.label]]),s[6]||(s[6]=e("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded"},"Add Permission",-1))],32)]),e("table",B,[s[7]||(s[7]=e("thead",null,[e("tr",null,[e("th",{class:"border px-4 py-2"},"Name"),e("th",{class:"border px-4 py-2"},"Label"),e("th",{class:"border px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(d(!0),a(_,null,w(i.permissions,n=>(d(),a("tr",{key:n.id},[e("td",E,v(n.name),1),e("td",L,v(n.label),1),e("td",N,[e("button",{onClick:t=>i.editPermission(n),class:"text-blue-600 mr-2"},"Edit",8,F),e("button",{onClick:t=>i.deletePermission(n.id),class:"text-red-600"},"Delete",8,z)])]))),128))])]),i.editingPermission?(d(),a("div",O,[e("h2",T,"Edit Permission: "+v(i.editingPermission.name),1),e("form",{onSubmit:x(i.updatePermission,["prevent"])},[u(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>i.editingPermission.name=n),class:"border p-2 mr-2",required:""},null,512),[[c,i.editingPermission.name]]),u(e("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>i.editingPermission.label=n),class:"border p-2 mr-2"},null,512),[[c,i.editingPermission.label]]),s[8]||(s[8]=e("button",{type:"submit",class:"bg-green-600 text-white px-4 py-2 rounded"},"Save",-1)),e("button",{onClick:s[4]||(s[4]=n=>i.editingPermission=null),type:"button",class:"ml-2 px-4 py-2 rounded border"},"Cancel")],32),e("div",G,[s[9]||(s[9]=e("h3",{class:"font-semibold mb-1"},"Assign to Roles",-1)),e("div",null,[(d(!0),a(_,null,w(i.roles,n=>(d(),a("label",{key:n.id,class:"inline-flex items-center mr-3"},[u(e("input",{type:"checkbox",value:n.id,"onUpdate:modelValue":s[5]||(s[5]=t=>i.editingPermissionRoleIds=t),onChange:t=>i.toggleRole(n.id)},null,40,H),[[D,i.editingPermissionRoleIds]]),e("span",J,v(n.name),1)]))),128))])])])):U("v-if",!0)])}const X=j(q,[["render",K],["__file","/var/www/html/resources/js/Pages/Dashboard/Permissions.vue"]]);export{X as default};
