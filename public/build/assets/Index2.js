import{e as y,l as n,y as h,o as i,g as t,E as w,f as S,w as c,i as g,t as e,p as L,G as R,H as U,v as V,F,m as A,n as D,j as p,u as M,S as T,x as E}from"./vendor.js";import{_ as H}from"./AdminLayout.js";import{S as K}from"./SecondaryButton.js";import{D as I}from"./DangerButton.js";import"./NotificationDropdown.js";import"./app.js";/* empty css    */import"./_plugin-vue_export-helper.js";const O={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},z={class:"flex min-h-full items-center justify-center p-4"},G={class:"relative w-full max-w-md max-h-full"},P={class:"relative bg-white rounded-lg shadow"},q={__name:"ConfirmationModal",emits:["close"],setup(a,{emit:f}){const u=y(!1);return(d,r)=>u.value?(i(),n("div",O,[t("div",z,[t("div",G,[t("div",P,[t("button",{onClick:r[0]||(r[0]=_=>d.$emit("close")),class:"absolute top-3 right-3 text-gray-400 hover:text-gray-500"},r[1]||(r[1]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),w(d.$slots,"title"),w(d.$slots,"content"),w(d.$slots,"footer")])])])])):h("",!0)}},J={class:"font-semibold text-xl text-gray-800 leading-tight"},Q={class:"py-12"},W={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},X={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},Y={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},Z={class:"text-sm text-gray-500 mb-1"},tt={class:"text-2xl font-bold"},et={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},st={class:"text-sm text-gray-500 mb-1"},ot={class:"text-2xl font-bold text-green-600"},at={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},it={class:"text-sm text-gray-500 mb-1"},dt={class:"text-2xl font-bold"},rt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},lt={class:"text-sm text-gray-500 mb-1"},nt={class:"text-2xl font-bold"},ct={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ut={class:"p-6 bg-white border-b border-gray-200"},mt={class:"mb-6 flex flex-col md:flex-row md:items-center md:justify-between"},ht={class:"flex flex-col md:flex-row md:items-center space-y-3 md:space-y-0 md:space-x-4"},xt={value:""},pt={value:"active"},vt={value:"expired"},gt={value:"revoked"},yt={class:"flex"},ft={class:"mt-3 md:mt-0"},_t={key:0,class:"mb-6 bg-red-100 border-l-4 border-red-500 text-red-700 p-4"},wt={class:"overflow-x-auto"},bt={class:"min-w-full divide-y divide-gray-200"},$t={class:"bg-gray-50"},kt={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Ct={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},St={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Lt={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Ft={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},At={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Dt={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Mt={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Tt={class:"bg-white divide-y divide-gray-200"},jt={key:0},Bt={colspan:"8",class:"px-6 py-4 text-center text-gray-500"},Nt={class:"px-6 py-4 whitespace-nowrap"},Rt={class:"flex items-center"},Ut={class:"text-sm font-medium text-gray-900"},Vt={class:"text-sm text-gray-500"},Et={class:"px-6 py-4 whitespace-nowrap"},Ht={class:"text-sm text-gray-900 font-mono"},Kt={class:"text-xs text-gray-500"},It={class:"px-6 py-4 whitespace-nowrap"},Ot={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},zt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Gt={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"text-sm text-gray-900"},qt={key:0,class:"text-xs text-gray-500"},Jt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Qt={key:0,class:"text-xs text-green-600"},Wt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Xt=["onClick"],Yt={key:1,class:"mt-6"},Zt={class:"flex justify-between items-center"},te={class:"text-sm text-gray-700"},ee={class:"flex space-x-1"},se={class:"mt-2 text-sm text-gray-500"},oe={class:"text-sm text-gray-500"},he={__name:"Index",props:{licenses:Object,stats:Object,filters:Object,error:String},setup(a){var b,$;const f=a,u=y(!1),d=y(null),r=y({status:((b=f.filters)==null?void 0:b.status)||"",search:(($=f.filters)==null?void 0:$.search)||""}),_=o=>{if(!o)return"N/A";const l=new Date(o);return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).format(l)},v=()=>{window.location=route("admin.licenses.index",r.value)},j=()=>{r.value={status:"",search:""},v()},B=o=>{d.value=o,u.value=!0},N=()=>{if(!d.value)return;E({status:"revoked"}).post(route("admin.licenses.update-status",d.value.id),{preserveScroll:!0,onSuccess:()=>{u.value=!1,d.value=null}})};return(o,l)=>(i(),S(H,null,{header:c(()=>[t("h2",J,e(o.$t("License Management")),1)]),default:c(()=>{var k,C;return[t("div",Q,[t("div",W,[t("div",X,[t("div",Y,[t("div",Z,e(o.$t("Total Licenses")),1),t("div",tt,e(a.stats.total),1)]),t("div",et,[t("div",st,e(o.$t("Active Licenses")),1),t("div",ot,e(a.stats.active),1)]),t("div",at,[t("div",it,e(o.$t("Total Revenue")),1),t("div",dt,"CHF "+e(((k=a.stats.revenue)==null?void 0:k.toFixed(2))||"0.00"),1)]),t("div",rt,[t("div",lt,e(o.$t("Discounts Applied")),1),t("div",nt,e(a.stats.discounts_applied)+" (CHF "+e(((C=a.stats.discount_total)==null?void 0:C.toFixed(2))||"0.00")+")",1)])]),t("div",ct,[t("div",ut,[t("div",mt,[t("div",ht,[t("div",null,[L(t("select",{"onUpdate:modelValue":l[0]||(l[0]=s=>r.value.status=s),onChange:v,class:"rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},[t("option",xt,e(o.$t("All Statuses")),1),t("option",pt,e(o.$t("Active")),1),t("option",vt,e(o.$t("Expired")),1),t("option",gt,e(o.$t("Revoked")),1)],544),[[R,r.value.status]])]),t("div",yt,[L(t("input",{type:"text","onUpdate:modelValue":l[1]||(l[1]=s=>r.value.search=s),onKeyup:U(v,["enter"]),placeholder:"Search by key, user, email...",class:"rounded-l-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,544),[[V,r.value.search]]),t("button",{onClick:v,class:"px-4 py-2 bg-blue-600 text-white rounded-r-md hover:bg-blue-700"},e(o.$t("Search")),1)])]),t("div",ft,[t("button",{onClick:j,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300"},e(o.$t("Reset Filters")),1)])]),a.error?(i(),n("div",_t,[t("p",null,e(a.error),1)])):h("",!0),t("div",wt,[t("table",bt,[t("thead",$t,[t("tr",null,[t("th",kt,e(o.$t("User")),1),t("th",Ct,e(o.$t("License Key")),1),t("th",St,e(o.$t("Status")),1),t("th",Lt,e(o.$t("Type")),1),t("th",Ft,e(o.$t("Issued")),1),t("th",At,e(o.$t("Expires")),1),t("th",Dt,e(o.$t("Amount")),1),t("th",Mt,e(o.$t("Actions")),1)])]),t("tbody",Tt,[a.licenses.data&&a.licenses.data.length===0?(i(),n("tr",jt,[t("td",Bt,e(o.$t("No licenses found.")),1)])):h("",!0),(i(!0),n(F,null,A(a.licenses.data,s=>{var m,x;return i(),n("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",Nt,[t("div",Rt,[t("div",null,[t("div",Ut,e(((m=s.user)==null?void 0:m.name)||"Unknown User"),1),t("div",Vt,e(((x=s.user)==null?void 0:x.email)||"No email"),1)])])]),t("td",Et,[t("div",Ht,e(s.license_key),1),t("div",Kt,e(s.payment_id),1)]),t("td",It,[t("span",{class:D({"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full":!0,"bg-green-100 text-green-800":s.is_active,"bg-red-100 text-red-800":s.is_expired||s.status==="revoked","bg-yellow-100 text-yellow-800":!s.is_active&&!s.is_expired&&s.status!=="revoked"})},e(s.status.charAt(0).toUpperCase()+s.status.slice(1)),3)]),t("td",Ot,e(s.type),1),t("td",zt,e(_(s.issued_at)),1),t("td",Gt,[t("div",Pt,e(_(s.expires_at)),1),s.days_remaining!==null?(i(),n("div",qt,e(s.days_remaining>0?`${s.days_remaining} days left`:"Expired"),1)):h("",!0)]),t("td",Jt,[p(e(s.currency)+" "+e(s.amount.toFixed(2))+" ",1),s.discount_applied?(i(),n("div",Qt," -"+e(s.currency)+" "+e(s.discount_amount.toFixed(2))+" discount ",1)):h("",!0)]),t("td",Wt,[g(M(T),{href:o.route("admin.licenses.show",s.id),class:"text-blue-600 hover:text-blue-900 mr-3"},{default:c(()=>[p(e(o.$t("View")),1)]),_:2},1032,["href"]),s.status!=="revoked"?(i(),n("button",{key:0,onClick:ae=>B(s),class:"text-red-600 hover:text-red-900"},e(o.$t("Revoke")),9,Xt)):h("",!0)])])}),128))])])]),a.licenses.links&&a.licenses.links.length>3?(i(),n("div",Yt,[t("div",Zt,[t("div",te,e(o.$t("Showing"))+" "+e(a.licenses.from)+" "+e(o.$t("to"))+" "+e(a.licenses.to)+" "+e(o.$t("of"))+" "+e(a.licenses.total)+" "+e(o.$t("results")),1),t("div",ee,[(i(!0),n(F,null,A(a.licenses.links,(s,m)=>(i(),S(M(T),{key:m,href:s.url,class:D({"px-4 py-2 text-sm rounded-md":!0,"bg-blue-600 text-white":s.active,"bg-white text-gray-700 hover:bg-gray-50":!s.active,"opacity-50 cursor-not-allowed":!s.url,hidden:s.label==="« Previous"||s.label==="Next »"}),innerHTML:s.label},null,8,["href","class","innerHTML"]))),128))])])])):h("",!0)])])])]),g(q,{show:u.value,onClose:l[3]||(l[3]=s=>u.value=!1)},{title:c(()=>[p(e(o.$t("Revoke License")),1)]),content:c(()=>{var s,m,x;return[t("p",null,e(o.$t("Are you sure you want to revoke this license? This action cannot be undone.")),1),t("p",se,e(o.$t("License Key"))+": "+e((s=d.value)==null?void 0:s.license_key),1),t("p",oe,e(o.$t("User"))+": "+e((x=(m=d.value)==null?void 0:m.user)==null?void 0:x.name),1)]}),footer:c(()=>[g(K,{onClick:l[2]||(l[2]=s=>u.value=!1)},{default:c(()=>[p(e(o.$t("Cancel")),1)]),_:1}),g(I,{class:"ml-3",onClick:N},{default:c(()=>[p(e(o.$t("Revoke License")),1)]),_:1})]),_:1},8,["show"])]}),_:1}))}};export{he as default};
