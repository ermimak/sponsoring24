import{k as c,y as n,o as d,f as e,E as b,m as f,e as C,w as h,g as y,t,q as S,G as j,H as B,v as T,F,l as M,n as $,i as g,p as N,x as D,S as U}from"./vendor.js";import{A as V}from"./AdminLayout.js";import{_ as A}from"./_plugin-vue_export-helper.js";import{S as E}from"./SecondaryButton.js";import{D as H}from"./DangerButton.js";import"./NotificationDropdown.js";import"./app.js";/* empty css    */const I={__name:"ConfirmationModal",emits:["close"],setup(o,{expose:r,emit:a}){r();const i=f(!1),l=a;function _(){i.value=!1,l("close")}const u={show:i,emit:l,close:_,ref:f};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}},O={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},P={class:"flex min-h-full items-center justify-center p-4"},K={class:"relative w-full max-w-md max-h-full"},z={class:"relative bg-white rounded-lg shadow"};function G(o,r,a,i,l,_){return i.show?(d(),c("div",O,[e("div",P,[e("div",K,[e("div",z,[e("button",{onClick:r[0]||(r[0]=u=>o.$emit("close")),class:"absolute top-3 right-3 text-gray-400 hover:text-gray-500"},r[1]||(r[1]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),b(o.$slots,"title"),b(o.$slots,"content"),b(o.$slots,"footer")])])])])):n("v-if",!0)}const q=A(I,[["render",G],["__file","/var/www/html/resources/js/Components/ConfirmationModal.vue"]]),J={__name:"Index",props:{licenses:Object,stats:Object,filters:Object,error:String},setup(o,{expose:r}){var k,L;r();const a=o,i=f(!1),l=f(null),_=f({status:((k=a.filters)==null?void 0:k.status)||"",search:((L=a.filters)==null?void 0:L.search)||""}),u=v=>{if(!v)return"N/A";const R=new Date(v);return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).format(R)},p=()=>{window.location=route("admin.licenses.index",_.value)},w={props:a,showRevokeModal:i,selectedLicense:l,filters:_,formatDate:u,applyFilters:p,resetFilters:()=>{_.value={status:"",search:""},p()},confirmRevokeDialog:v=>{l.value=v,i.value=!0},revokeLicense:()=>{if(!l.value)return;D({status:"revoked"}).post(route("admin.licenses.update-status",l.value.id),{preserveScroll:!0,onSuccess:()=>{i.value=!1,l.value=null}})},ref:f,computed:N,get Link(){return U},get useForm(){return D},AdminLayout:V,ConfirmationModal:q,SecondaryButton:E,DangerButton:H};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}},Q={class:"font-semibold text-xl text-gray-800 leading-tight"},W={class:"py-12"},X={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Y={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},Z={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},ee={class:"text-sm text-gray-500 mb-1"},te={class:"text-2xl font-bold"},se={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},oe={class:"text-sm text-gray-500 mb-1"},ie={class:"text-2xl font-bold text-green-600"},ae={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},re={class:"text-sm text-gray-500 mb-1"},ne={class:"text-2xl font-bold"},de={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},le={class:"text-sm text-gray-500 mb-1"},ce={class:"text-2xl font-bold"},ue={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},me={class:"p-6 bg-white border-b border-gray-200"},he={class:"mb-6 flex flex-col md:flex-row md:items-center md:justify-between"},_e={class:"flex flex-col md:flex-row md:items-center space-y-3 md:space-y-0 md:space-x-4"},xe={value:""},fe={value:"active"},pe={value:"expired"},ve={value:"revoked"},ge={class:"flex"},ye={class:"mt-3 md:mt-0"},we={key:0,class:"mb-6 bg-red-100 border-l-4 border-red-500 text-red-700 p-4"},be={class:"overflow-x-auto"},ke={class:"min-w-full divide-y divide-gray-200"},Le={class:"bg-gray-50"},Ce={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Se={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Fe={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Me={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},$e={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},De={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Ae={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Re={scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},je={class:"bg-white divide-y divide-gray-200"},Be={key:0},Te={colspan:"8",class:"px-6 py-4 text-center text-gray-500"},Ne={class:"px-6 py-4 whitespace-nowrap"},Ue={class:"flex items-center"},Ve={class:"text-sm font-medium text-gray-900"},Ee={class:"text-sm text-gray-500"},He={class:"px-6 py-4 whitespace-nowrap"},Ie={class:"text-sm text-gray-900 font-mono"},Oe={class:"text-xs text-gray-500"},Pe={class:"px-6 py-4 whitespace-nowrap"},Ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ze={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ge={class:"px-6 py-4 whitespace-nowrap"},qe={class:"text-sm text-gray-900"},Je={key:0,class:"text-xs text-gray-500"},Qe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},We={key:0,class:"text-xs text-green-600"},Xe={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ye=["onClick"],Ze={key:1,class:"mt-6"},et={class:"flex justify-between items-center"},tt={class:"text-sm text-gray-700"},st={class:"flex space-x-1"},ot={class:"mt-2 text-sm text-gray-500"},it={class:"text-sm text-gray-500"};function at(o,r,a,i,l,_){return d(),C(i.AdminLayout,null,{header:h(()=>[e("h2",Q,t(o.$t("License Management")),1)]),default:h(()=>{var u,p;return[e("div",W,[e("div",X,[n(" Stats Cards "),e("div",Y,[e("div",Z,[e("div",ee,t(o.$t("Total Licenses")),1),e("div",te,t(a.stats.total),1)]),e("div",se,[e("div",oe,t(o.$t("Active Licenses")),1),e("div",ie,t(a.stats.active),1)]),e("div",ae,[e("div",re,t(o.$t("Total Revenue")),1),e("div",ne,"CHF "+t(((u=a.stats.revenue)==null?void 0:u.toFixed(2))||"0.00"),1)]),e("div",de,[e("div",le,t(o.$t("Discounts Applied")),1),e("div",ce,t(a.stats.discounts_applied)+" (CHF "+t(((p=a.stats.discount_total)==null?void 0:p.toFixed(2))||"0.00")+")",1)])]),e("div",ue,[e("div",me,[n(" Filters "),e("div",he,[e("div",_e,[e("div",null,[S(e("select",{"onUpdate:modelValue":r[0]||(r[0]=s=>i.filters.status=s),onChange:i.applyFilters,class:"rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},[e("option",xe,t(o.$t("All Statuses")),1),e("option",fe,t(o.$t("Active")),1),e("option",pe,t(o.$t("Expired")),1),e("option",ve,t(o.$t("Revoked")),1)],544),[[j,i.filters.status]])]),e("div",ge,[S(e("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=s=>i.filters.search=s),onKeyup:B(i.applyFilters,["enter"]),placeholder:"Search by key, user, email...",class:"rounded-l-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,544),[[T,i.filters.search]]),e("button",{onClick:i.applyFilters,class:"px-4 py-2 bg-blue-600 text-white rounded-r-md hover:bg-blue-700"},t(o.$t("Search")),1)])]),e("div",ye,[e("button",{onClick:i.resetFilters,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300"},t(o.$t("Reset Filters")),1)])]),n(" Error Message "),a.error?(d(),c("div",we,[e("p",null,t(a.error),1)])):n("v-if",!0),n(" Licenses Table "),e("div",be,[e("table",ke,[e("thead",Le,[e("tr",null,[e("th",Ce,t(o.$t("User")),1),e("th",Se,t(o.$t("License Key")),1),e("th",Fe,t(o.$t("Status")),1),e("th",Me,t(o.$t("Type")),1),e("th",$e,t(o.$t("Issued")),1),e("th",De,t(o.$t("Expires")),1),e("th",Ae,t(o.$t("Amount")),1),e("th",Re,t(o.$t("Actions")),1)])]),e("tbody",je,[a.licenses.data&&a.licenses.data.length===0?(d(),c("tr",Be,[e("td",Te,t(o.$t("No licenses found.")),1)])):n("v-if",!0),(d(!0),c(F,null,M(a.licenses.data,s=>{var m,x;return d(),c("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Ne,[e("div",Ue,[e("div",null,[e("div",Ve,t(((m=s.user)==null?void 0:m.name)||"Unknown User"),1),e("div",Ee,t(((x=s.user)==null?void 0:x.email)||"No email"),1)])])]),e("td",He,[e("div",Ie,t(s.license_key),1),e("div",Oe,t(s.payment_id),1)]),e("td",Pe,[e("span",{class:$({"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full":!0,"bg-green-100 text-green-800":s.is_active,"bg-red-100 text-red-800":s.is_expired||s.status==="revoked","bg-yellow-100 text-yellow-800":!s.is_active&&!s.is_expired&&s.status!=="revoked"})},t(s.status.charAt(0).toUpperCase()+s.status.slice(1)),3)]),e("td",Ke,t(s.type),1),e("td",ze,t(i.formatDate(s.issued_at)),1),e("td",Ge,[e("div",qe,t(i.formatDate(s.expires_at)),1),s.days_remaining!==null?(d(),c("div",Je,t(s.days_remaining>0?`${s.days_remaining} days left`:"Expired"),1)):n("v-if",!0)]),e("td",Qe,[g(t(s.currency)+" "+t(s.amount.toFixed(2))+" ",1),s.discount_applied?(d(),c("div",We," -"+t(s.currency)+" "+t(s.discount_amount.toFixed(2))+" discount ",1)):n("v-if",!0)]),e("td",Xe,[y(i.Link,{href:o.route("admin.licenses.show",s.id),class:"text-blue-600 hover:text-blue-900 mr-3"},{default:h(()=>[g(t(o.$t("View")),1)]),_:2},1032,["href"]),s.status!=="revoked"?(d(),c("button",{key:0,onClick:w=>i.confirmRevokeDialog(s),class:"text-red-600 hover:text-red-900"},t(o.$t("Revoke")),9,Ye)):n("v-if",!0)])])}),128))])])]),n(" Pagination "),a.licenses.links&&a.licenses.links.length>3?(d(),c("div",Ze,[e("div",et,[e("div",tt,t(o.$t("Showing"))+" "+t(a.licenses.from)+" "+t(o.$t("to"))+" "+t(a.licenses.to)+" "+t(o.$t("of"))+" "+t(a.licenses.total)+" "+t(o.$t("results")),1),e("div",st,[(d(!0),c(F,null,M(a.licenses.links,(s,m)=>(d(),C(i.Link,{key:m,href:s.url,class:$({"px-4 py-2 text-sm rounded-md":!0,"bg-blue-600 text-white":s.active,"bg-white text-gray-700 hover:bg-gray-50":!s.active,"opacity-50 cursor-not-allowed":!s.url,hidden:s.label==="« Previous"||s.label==="Next »"}),innerHTML:s.label},null,8,["href","class","innerHTML"]))),128))])])])):n("v-if",!0)])])])]),y(i.ConfirmationModal,{show:i.showRevokeModal,onClose:r[3]||(r[3]=s=>i.showRevokeModal=!1)},{title:h(()=>[g(t(o.$t("Revoke License")),1)]),content:h(()=>{var s,m,x;return[e("p",null,t(o.$t("Are you sure you want to revoke this license? This action cannot be undone.")),1),e("p",ot,t(o.$t("License Key"))+": "+t((s=i.selectedLicense)==null?void 0:s.license_key),1),e("p",it,t(o.$t("User"))+": "+t((x=(m=i.selectedLicense)==null?void 0:m.user)==null?void 0:x.name),1)]}),footer:h(()=>[y(i.SecondaryButton,{onClick:r[2]||(r[2]=s=>i.showRevokeModal=!1)},{default:h(()=>[g(t(o.$t("Cancel")),1)]),_:1}),y(i.DangerButton,{class:"ml-3",onClick:i.revokeLicense},{default:h(()=>[g(t(o.$t("Revoke License")),1)]),_:1})]),_:1},8,["show"])]}),_:1})}const _t=A(J,[["render",at],["__file","/var/www/html/resources/js/Pages/Admin/Licenses/Index.vue"]]);export{_t as default};
