import{z as F,c as G,o as m,i as d,w as y,d as b,e as _,T as S,b as N,a as t,m as V,h as f,A as P,B as T,k as q,r as C,s as A,C as Q,y as h,D as L,t as c,f as W,v as H,F as J,j as X}from"./app-BDDThPdq.js";import{D as Z}from"./DashboardLayout-DX3pOCJ2.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */import"./SidebarLink-BeQ8zajy.js";const te={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},se={class:"text-lg font-medium text-gray-900"},oe={class:"px-6 py-4"},ae={key:0,class:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3"},D={__name:"Modal",props:{show:{type:Boolean,default:!1},closeOnBackdrop:{type:Boolean,default:!0},maxWidth:{type:String,default:"2xl"}},emits:["close"],setup(r,{emit:u}){const g=r;return F(()=>g.show,l=>{l?document.body.style.overflow="hidden":document.body.style.overflow=null}),(l,n)=>(m(),G(P,{to:"body"},[d(S,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:y(()=>[r.show?(m(),b("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:n[2]||(n[2]=p=>r.closeOnBackdrop?l.$emit("close"):null)},[d(S,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to-class":"opacity-100 translate-y-0 sm:scale-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100 translate-y-0 sm:scale-100","leave-to-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:y(()=>[r.show?(m(),b("div",{key:0,class:"bg-white rounded-lg overflow-hidden shadow-xl transform transition-all w-full max-w-lg mx-4 sm:mx-0",onClick:n[1]||(n[1]=N(()=>{},["stop"]))},[t("div",te,[t("h3",se,[V(l.$slots,"title",{},()=>[n[3]||(n[3]=f("Modal Title"))])]),t("button",{type:"button",class:"text-gray-400 hover:text-gray-500",onClick:n[0]||(n[0]=p=>l.$emit("close"))},n[4]||(n[4]=[t("span",{class:"sr-only"},"Close",-1),t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",oe,[V(l.$slots,"content")]),l.$slots.footer?(m(),b("div",ae,[V(l.$slots,"footer")])):_("",!0)])):_("",!0)]),_:3})])):_("",!0)]),_:3})]))}},le=["type","disabled"],B={__name:"Button",props:{type:{type:String,default:"button"},variant:{type:String,default:"primary",validator:r=>["primary","secondary","danger","success","warning","info"].includes(r)},disabled:{type:Boolean,default:!1},size:{type:String,default:"md",validator:r=>["sm","md","lg"].includes(r)}},setup(r){const u=r,g=T(()=>{const l={primary:"bg-primary text-white hover:bg-primary-dark focus:ring-primary",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-300",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",warning:"bg-yellow-500 text-white hover:bg-yellow-600 focus:ring-yellow-400",info:"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-400"},n={sm:"text-xs px-2.5 py-1.5",md:"text-sm px-4 py-2",lg:"text-base px-6 py-3"};return`${l[u.variant]} ${n[u.size]} ${u.disabled?"opacity-50 cursor-not-allowed":""}`});return(l,n)=>(m(),b("button",{type:r.type,class:q(["inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md font-semibold text-xs uppercase tracking-widest focus:outline-none focus:ring-2 focus:ring-offset-2 transition ease-in-out duration-150",g.value]),disabled:r.disabled},[V(l.$slots,"default")],10,le))}},re=["value","disabled"],k={__name:"Input",props:{modelValue:{type:[String,Number],default:""},error:{type:[String,Boolean],default:!1},disabled:{type:Boolean,default:!1},inputClass:{type:String,default:""},autofocus:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r){const u=r,g=C(null);return A(()=>{var l;u.autofocus&&((l=g.value)==null||l.focus())}),F(()=>u.autofocus,l=>{var n;l&&((n=g.value)==null||n.focus())}),(l,n)=>(m(),b("input",Q({value:r.modelValue,onInput:n[0]||(n[0]=p=>l.$emit("update:modelValue",p.target.value)),class:["border-gray-300 focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50 rounded-md shadow-sm",[r.error?"border-red-500 focus:border-red-500 focus:ring-red-500":"",r.disabled?"bg-gray-100 cursor-not-allowed":"",r.inputClass]],disabled:r.disabled,ref_key:"input",ref:g},l.$attrs),null,16,re))}},ne={class:"flex justify-between items-center mb-6"},ie={class:"text-2xl font-bold"},de={class:"text-gray-400 text-base font-normal"},ue={class:"flex gap-2 items-center"},me=["disabled"],pe=["disabled"],ce={class:"flex flex-col md:flex-row gap-4 mb-4"},fe={class:"bg-gray-50 border rounded p-4 w-full md:w-1/4"},be={class:"flex-1 overflow-x-auto"},ge={class:"min-w-full divide-y divide-gray-200 bg-white rounded-lg border"},ye={class:"bg-white divide-y divide-gray-200"},ve={class:"px-6 py-4 whitespace-nowrap"},xe=["onClick"],we={class:"px-6 py-4 whitespace-nowrap"},he={class:"px-6 py-4 whitespace-nowrap"},ke=["onClick"],Ce={class:"px-6 py-4 whitespace-nowrap"},Me={class:"px-6 py-4 whitespace-nowrap"},_e={class:"px-6 py-4 whitespace-nowrap"},$e={class:"px-6 py-4 whitespace-nowrap"},Ve={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium flex items-center gap-2"},Ee=["onClick"],Ne=["onClick","disabled"],Ae={key:0},Ie={key:0,class:"p-4 text-center text-gray-500"},Se={key:1,class:"p-4 text-center text-red-500"},Le={key:2,class:"p-4 text-center text-green-500"},De={class:"mb-4"},Be={class:"mb-4"},Fe={class:"mb-4"},Ge={class:"mb-4"},Te={class:"mb-4"},Ue={class:"mb-4"},je={class:"mb-4"},ze={class:"mb-4"},Oe={__name:"Index",props:{members:Array},setup(r){h.defaults.baseURL=window.location.origin,window.location.hostname==="localhost"&&(h.defaults.baseURL="http://localhost");const u=r,g=C(""),l=C(!1),n=C(!1),p=C(null),v=C(!0),x=C(null),w=C({first_name:"",last_name:"",email:"",member_id:""});A(()=>{var s;console.log("Members/Index component mounted"),console.log("Members count:",((s=u.members)==null?void 0:s.length)||0),v.value=!1});const E=T(()=>{if(!u.members)return[];if(!g.value)return u.members;const s=g.value.toLowerCase();return u.members.filter(e=>e.first_name&&e.first_name.toLowerCase().includes(s)||e.last_name&&e.last_name.toLowerCase().includes(s)||e.email&&e.email.toLowerCase().includes(s)||e.member_id&&e.member_id.toLowerCase().includes(s))});function U(){showImportExport.value=!0}function j(s=null){editingMember.value=s,editingGroup.value=s?{id:null,name:Array.isArray(s.groups)?s.groups.join(", "):""}:null,showGroupModal.value=!0}async function z(s){var e,i;try{if(editingMember.value){const a=s.name?s.name.split(",").map(o=>o.trim()).filter(o=>o):[];await h.put(`/dashboard/members/${editingMember.value.id}`,{groups:a}),message.value="Member groups updated!"}else await h.post("/dashboard/members/groups",{name:s.name}),message.value="Group saved!";showGroupModal.value=!1,editingMember.value=null,editingGroup.value=null,$()}catch(a){x.value=((i=(e=a.response)==null?void 0:e.data)==null?void 0:i.message)||"Failed to save groups."}}async function O(s){var i,a;const e=new FormData;e.append("file",s);try{const o=await h.post("/dashboard/members/import",e,{headers:{"Content-Type":"multipart/form-data"}});message.value=o.data.message,showImportExport.value=!1,$()}catch(o){x.value=((a=(i=o.response)==null?void 0:i.data)==null?void 0:a.message)||"Failed to import members."}}function R(){showImportExport.value=!1}async function K(){var s,e;try{exporting.value=!0;const i=await h.get("/dashboard/members/export",{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([i.data])),o=document.createElement("a");o.href=a,o.setAttribute("download","participants.xlsx"),document.body.appendChild(o),o.click(),document.body.removeChild(o),message.value="Export successful!"}catch(i){x.value=((e=(s=i.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to export members."}finally{exporting.value=!1}}async function $(){var s,e;v.value=!0,x.value="",message.value="";try{const i=await h.get("/dashboard/members");members.value=i.data.map(a=>({id:a.id,name:`${a.first_name||""} ${a.last_name||""}`.trim()||"N/A",member_id:a.member_id||"N/A",groups:Array.isArray(a.member_groups)?a.member_groups.map(o=>o.name):[],public_registration:!!a.public_registration,email_status:a.email_status||"OK",archived:!!a.archived,added:a.created_at?new Date(a.created_at).toLocaleDateString()+" "+new Date(a.created_at).toLocaleTimeString().slice(0,5):"N/A"}))}catch(i){x.value=((e=(s=i.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to load members."}finally{v.value=!1}}async function Y(s){var e,i,a,o;if(confirm(`Are you sure you want to delete ${s.name||"this member"}?`))try{v.value=!0,await h.delete(`/dashboard/members/${s.id}`),message.value="Member deleted successfully!",await $()}catch(M){x.value=((e=M.response)==null?void 0:e.status)===404?"Member not found.":((i=M.response)==null?void 0:i.status)===403?"You do not have permission to delete this member.":((o=(a=M.response)==null?void 0:a.data)==null?void 0:o.message)||"Failed to delete member."}finally{v.value=!1}}function I(s){router.visit(`/dashboard/members/${s.id}/edit`)}return A(()=>{u.members.length>0?members.value=u.members.map(s=>({id:s.id,name:`${s.first_name||""} ${s.last_name||""}`.trim()||"N/A",member_id:s.member_id||"N/A",groups:Array.isArray(s.member_groups)?s.member_groups.map(e=>e.name):[],public_registration:!!s.public_registration,email_status:s.email_status||"OK",archived:!!s.archived,added:s.created_at?new Date(s.created_at).toLocaleDateString()+" "+new Date(s.created_at).toLocaleTimeString().slice(0,5):"N/A"})):$()}),(s,e)=>{const i=L("ImportExportModal"),a=L("GroupModal");return m(),G(Z,null,{default:y(()=>[t("div",null,[t("div",ne,[t("h1",ie,[e[14]||(e[14]=f("Members ")),t("span",de,c(E.value.length)+" entries",1)]),t("div",ue,[t("button",{onClick:e[0]||(e[0]=(...o)=>s.redirectToGroups&&s.redirectToGroups(...o)),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded flex items-center",disabled:v.value},e[15]||(e[15]=[t("i",{class:"fas fa-users mr-2"},null,-1),f(" Member groups ")]),8,me),t("button",{onClick:K,class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded flex items-center",disabled:s.exporting},[e[16]||(e[16]=t("i",{class:"fas fa-file-export mr-2"},null,-1)),f(" "+c(s.exporting?"Exporting...":"Export"),1)],8,pe),t("button",{onClick:U,class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded flex items-center"},e[17]||(e[17]=[t("i",{class:"fas fa-file-import mr-2"},null,-1),f(" Import ")])),e[19]||(e[19]=t("button",{class:"rounded-full bg-gray-100 p-2 hover:bg-gray-200"},[t("i",{class:"fas fa-filter text-gray-500"})],-1)),t("button",{onClick:e[1]||(e[1]=(...o)=>s.redirectToCreate&&s.redirectToCreate(...o)),class:"rounded-full bg-yellow-400 hover:bg-yellow-500 text-white text-2xl flex items-center justify-center w-10 h-10"},e[18]||(e[18]=[t("i",{class:"fas fa-plus"},null,-1)]))])]),t("div",ce,[t("div",fe,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium mb-1"},"Search",-1)),W(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.search=o),type:"text",class:"input w-full mb-2",placeholder:"Search"},null,512),[[H,s.search]])]),t("div",be,[t("table",ge,[e[24]||(e[24]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Member ID"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Groups"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Public Registration"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Archived"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Added"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",ye,[(m(!0),b(J,null,X(E.value,o=>(m(),b("tr",{key:o.id},[t("td",ve,[t("button",{onClick:M=>I(o),class:"text-indigo-600 hover:text-indigo-900 font-medium"},c(o.name),9,xe)]),t("td",we,c(o.member_id||"N/A"),1),t("td",he,[t("button",{onClick:M=>j(o),class:"text-indigo-600 hover:text-indigo-900"},c((o.groups||[]).join(", ")||"None"),9,ke)]),t("td",Ce,c(o.public_registration?"Yes":"No"),1),t("td",Me,c(o.email_status||"OK"),1),t("td",_e,c(o.archived?"Yes":"No"),1),t("td",$e,c(o.added||"N/A"),1),t("td",Ve,[t("button",{onClick:M=>I(o),class:"text-indigo-600 hover:text-indigo-900 flex items-center gap-1"},e[21]||(e[21]=[t("i",{class:"fas fa-edit"},null,-1),f(" Edit ")]),8,Ee),t("button",{onClick:M=>Y(o),class:"text-red-600 hover:text-red-900 flex items-center gap-1",disabled:v.value},e[22]||(e[22]=[t("i",{class:"fas fa-trash"},null,-1),f(" Delete ")]),8,Ne)])]))),128)),E.value.length===0?(m(),b("tr",Ae,e[23]||(e[23]=[t("td",{colspan:"8",class:"px-6 py-4 text-center text-gray-400"},"No entries found 🥺",-1)]))):_("",!0)])])])]),d(i,{show:s.showImportExport,onClose:R,onImport:O},null,8,["show"]),d(a,{show:s.showGroupModal,group:s.editingGroup,member:s.editingMember,onSave:z,onClose:e[3]||(e[3]=()=>s.showGroupModal=!1)},null,8,["show","group","member"]),v.value?(m(),b("div",Ie,"Loading...")):_("",!0),x.value?(m(),b("div",Se,c(x.value),1)):_("",!0),s.message?(m(),b("div",Le,c(s.message),1)):_("",!0)]),d(D,{show:l.value,onClose:s.closeCreateModal},{title:y(()=>e[25]||(e[25]=[f("Create Member")])),content:y(()=>[t("form",{onSubmit:e[8]||(e[8]=N((...o)=>s.submitCreateForm&&s.submitCreateForm(...o),["prevent"]))},[t("div",De,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium mb-1"},"First Name",-1)),d(k,{type:"text",class:"input w-full mb-2",modelValue:w.value.first_name,"onUpdate:modelValue":e[4]||(e[4]=o=>w.value.first_name=o)},null,8,["modelValue"])]),t("div",Be,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium mb-1"},"Last Name",-1)),d(k,{type:"text",class:"input w-full mb-2",modelValue:w.value.last_name,"onUpdate:modelValue":e[5]||(e[5]=o=>w.value.last_name=o)},null,8,["modelValue"])]),t("div",Fe,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium mb-1"},"Email",-1)),d(k,{type:"email",class:"input w-full mb-2",modelValue:w.value.email,"onUpdate:modelValue":e[6]||(e[6]=o=>w.value.email=o)},null,8,["modelValue"])]),t("div",Ge,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium mb-1"},"Member ID",-1)),d(k,{type:"text",class:"input w-full mb-2",modelValue:w.value.member_id,"onUpdate:modelValue":e[7]||(e[7]=o=>w.value.member_id=o)},null,8,["modelValue"])]),d(B,{type:"submit",class:"bg-yellow-400 hover:bg-yellow-500 text-white"},{default:y(()=>e[30]||(e[30]=[f("Create")])),_:1})],32)]),_:1},8,["show","onClose"]),d(D,{show:n.value,onClose:s.closeEditModal},{title:y(()=>e[31]||(e[31]=[f("Edit Member")])),content:y(()=>[t("form",{onSubmit:e[13]||(e[13]=N((...o)=>s.submitEditForm&&s.submitEditForm(...o),["prevent"]))},[t("div",Te,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium mb-1"},"First Name",-1)),d(k,{type:"text",class:"input w-full mb-2",modelValue:p.value.first_name,"onUpdate:modelValue":e[9]||(e[9]=o=>p.value.first_name=o)},null,8,["modelValue"])]),t("div",Ue,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium mb-1"},"Last Name",-1)),d(k,{type:"text",class:"input w-full mb-2",modelValue:p.value.last_name,"onUpdate:modelValue":e[10]||(e[10]=o=>p.value.last_name=o)},null,8,["modelValue"])]),t("div",je,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium mb-1"},"Email",-1)),d(k,{type:"email",class:"input w-full mb-2",modelValue:p.value.email,"onUpdate:modelValue":e[11]||(e[11]=o=>p.value.email=o)},null,8,["modelValue"])]),t("div",ze,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium mb-1"},"Member ID",-1)),d(k,{type:"text",class:"input w-full mb-2",modelValue:p.value.member_id,"onUpdate:modelValue":e[12]||(e[12]=o=>p.value.member_id=o)},null,8,["modelValue"])]),d(B,{type:"submit",class:"bg-yellow-400 hover:bg-yellow-500 text-white"},{default:y(()=>e[36]||(e[36]=[f("Update")])),_:1})],32)]),_:1},8,["show","onClose"])]),_:1})}}},Qe=ee(Oe,[["__scopeId","data-v-635f5478"]]);export{Qe as default};
