import{k as i,o as c,f as a,y as l,t as y,n as M,F as j,l as I,j as O,g as R,w as L,i as V,m as C,p,I as S,M as D,W as _,S as E}from"./vendor.js";import{r as v}from"./app.js";import{_ as T}from"./_plugin-vue_export-helper.js";const B={__name:"NotificationDropdown",props:{notifications:{type:Array,default:()=>[]}},setup(x,{expose:s}){s();const r=x,t=C(!1),d=p(()=>Array.isArray(r.notifications)?r.notifications:r.notifications&&r.notifications.data&&Array.isArray(r.notifications.data)?r.notifications.data:[]),b=p(()=>d.value.length>0),n=p(()=>d.value.filter(e=>!e.read_at).length),f=e=>{t.value&&!e.target.closest(".relative")&&(t.value=!1)};S(()=>{document.addEventListener("click",f),console.log("Notifications prop:",r.notifications),console.log("Notifications type:",typeof r.notifications),console.log("Is Array?",Array.isArray(r.notifications)),console.log("Length:",r.notifications?r.notifications.length:"N/A")}),D(()=>{document.removeEventListener("click",f)});const w={props:r,isOpen:t,notificationsArray:d,hasNotifications:b,unreadCount:n,handleClickOutside:f,formatDate:e=>{const o=new Date(e),N=Math.floor((new Date-o)/1e3);if(N<60)return"just now";const u=Math.floor(N/60);if(u<60)return`${u} ${u===1?"minute":"minutes"} ago`;const g=Math.floor(u/60);if(g<24)return`${g} ${g===1?"hour":"hours"} ago`;const m=Math.floor(g/24);if(m<30)return`${m} ${m===1?"day":"days"} ago`;const h=Math.floor(m/30);if(h<12)return`${h} ${h===1?"month":"months"} ago`;const A=Math.floor(h/12);return`${A} ${A===1?"year":"years"} ago`},getNotificationTitle:e=>{try{if(!e)return"Notification";let o;if(typeof e.data=="string")try{o=JSON.parse(e.data)}catch{o={}}else o=e.data||{};if(!o||!o.type)return o&&o.message?o.message:"Notification";switch(o.type){case"account_approval":return"Account Approved";case"account_pending":return"Account Pending";case"account_rejection":return"Account Rejected";case"payment_received":return"Payment Received";case"project_update":return"Project Update";case"new_donation":return"New Donation";default:return o.message||"Notification"}}catch(o){return console.error("Error in getNotificationTitle:",o),"Notification"}},getNotificationMessage:e=>{try{if(!e)return"";let o;if(typeof e.data=="string")try{o=JSON.parse(e.data)}catch{o={}}else o=e.data||{};return o.message||""}catch(o){return console.error("Error in getNotificationMessage:",o),""}},markAsRead:e=>{_.post(v("dashboard.notifications.mark-as-read",{notification:e.id}),{},{preserveScroll:!0,onSuccess:()=>{e.read_at=new Date().toISOString()}})},markAllAsRead:()=>{_.post(v("dashboard.notifications.mark-all-as-read"),{},{preserveScroll:!0,onSuccess:()=>{d.value.forEach(e=>{e.read_at||(e.read_at=new Date().toISOString())})}})},ref:C,computed:p,onMounted:S,onUnmounted:D,get Link(){return E},get router(){return _},get route(){return v}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}},P={class:"relative"},z={key:0,class:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},F={key:0,class:"absolute right-0 mt-2 w-80 bg-white rounded-md shadow-lg overflow-hidden z-50"},H={class:"py-2 border-b border-gray-100"},J={class:"px-4 flex justify-between items-center"},U={class:"max-h-72 overflow-y-auto"},W={key:0,class:"py-4 px-4 text-center text-sm text-gray-500"},Y={class:"flex justify-between items-start"},q={class:"flex-1"},G={class:"text-sm text-gray-800 font-medium"},K={class:"text-xs text-gray-500 mt-1"},Q={class:"text-xs text-gray-400 mt-1"},X=["onClick"],Z={class:"py-2 px-4 border-t border-gray-100 text-center"};function $(x,s,r,t,d,b){return c(),i("div",P,[a("button",{onClick:s[0]||(s[0]=n=>t.isOpen=!t.isOpen),class:M(["flex items-center relative p-2 rounded-full hover:bg-gray-100 transition-colors duration-200",{"bg-gray-100":t.unreadCount>0}])},[s[1]||(s[1]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),t.unreadCount>0?(c(),i("span",z,y(t.unreadCount>9?"9+":t.unreadCount),1)):l("v-if",!0)],2),t.isOpen?(c(),i("div",F,[a("div",H,[a("div",J,[s[2]||(s[2]=a("h3",{class:"text-sm font-semibold text-gray-700"},"Notifications",-1)),t.unreadCount>0?(c(),i("button",{key:0,onClick:t.markAllAsRead,class:"text-xs text-blue-600 hover:text-blue-800"}," Mark all as read ")):l("v-if",!0)])]),a("div",U,[t.hasNotifications?l("v-if",!0):(c(),i("div",W," No notifications ")),(c(!0),i(j,null,I(t.notificationsArray,n=>(c(),i("div",{key:n.id,class:M(["px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 transition-colors duration-200",{"bg-blue-50":!n.read_at}])},[a("div",Y,[a("div",q,[a("p",G,y(t.getNotificationTitle(n)),1),a("p",K,y(t.getNotificationMessage(n)),1),a("p",Q,y(t.formatDate(n.created_at)),1)]),n.read_at?l("v-if",!0):(c(),i("button",{key:0,onClick:O(f=>t.markAsRead(n),["stop"]),class:"ml-2 text-xs text-blue-600 hover:text-blue-800"}," Mark as read ",8,X))])],2))),128))]),a("div",Z,[R(t.Link,{href:t.route("dashboard.notifications.index"),class:"text-xs text-blue-600 hover:text-blue-800"},{default:L(()=>s[3]||(s[3]=[V(" View all notifications ")])),_:1},8,["href"])])])):l("v-if",!0)])}const ct=T(B,[["render",$],["__file","/var/www/html/resources/js/Components/NotificationDropdown.vue"]]);export{ct as N};
