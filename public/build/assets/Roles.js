import{k as a,o as r,f as e,y as U,j as w,q as u,v,F as g,l as y,t as p,z as D,m,I as h,a as d}from"./vendor.js";import{_ as j}from"./_plugin-vue_export-helper.js";const q={__name:"Roles",setup(k,{expose:s}){s();const f=m([]),o=m([]),b=m({name:"",label:""}),i=m(null),n=m([]);async function l(){const t=await d.get("/api/roles");f.value=t.data}async function R(){const t=await d.get("/api/permissions");o.value=t.data}h(()=>{l(),R()});async function C(){await d.post("/api/roles",b.value),b.value={name:"",label:""},l()}function P(t){i.value={...t},n.value=t.permissions.map(c=>c.id)}async function V(){await d.put(`/api/roles/${i.value.id}`,i.value);for(const t of o.value){const c=n.value.includes(t.id),_=i.value.permissions.some(M=>M.id===t.id);c&&!_?await d.post(`/api/roles/${i.value.id}/assign-permission`,{permission_id:t.id}):!c&&_&&await d.post(`/api/roles/${i.value.id}/remove-permission`,{permission_id:t.id})}i.value=null,l()}async function S(t){await d.delete(`/api/roles/${t}`),l()}function I(t){}const x={roles:f,permissions:o,newRole:b,editingRole:i,editingRolePermissionIds:n,fetchRoles:l,fetchPermissions:R,createRole:C,editRole:P,updateRole:V,deleteRole:S,togglePermission:I,ref:m,onMounted:h,get axios(){return d}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}},A={class:"mb-4"},B={class:"min-w-full bg-white border"},E={class:"border px-4 py-2"},L={class:"border px-4 py-2"},N={class:"border px-4 py-2"},F={class:"border px-4 py-2"},z=["onClick"],O=["onClick"],T={key:0,class:"mt-6 p-4 border rounded bg-gray-50"},G={class:"font-semibold mb-2"},H={class:"mt-4"},J=["value","onChange"],K={class:"ml-1"};function Q(k,s,f,o,b,i){return r(),a("div",null,[s[10]||(s[10]=e("h1",{class:"text-2xl font-bold mb-4"},"Roles Management",-1)),e("div",A,[e("form",{onSubmit:w(o.createRole,["prevent"])},[u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>o.newRole.name=n),placeholder:"Role name",class:"border p-2 mr-2",required:""},null,512),[[v,o.newRole.name]]),u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>o.newRole.label=n),placeholder:"Label (optional)",class:"border p-2 mr-2"},null,512),[[v,o.newRole.label]]),s[6]||(s[6]=e("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded"},"Add Role",-1))],32)]),e("table",B,[s[7]||(s[7]=e("thead",null,[e("tr",null,[e("th",{class:"border px-4 py-2"},"Name"),e("th",{class:"border px-4 py-2"},"Label"),e("th",{class:"border px-4 py-2"},"Permissions"),e("th",{class:"border px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(r(!0),a(g,null,y(o.roles,n=>(r(),a("tr",{key:n.id},[e("td",E,p(n.name),1),e("td",L,p(n.label),1),e("td",N,[(r(!0),a(g,null,y(n.permissions,l=>(r(),a("span",{key:l.id,class:"inline-block bg-gray-200 rounded px-2 py-1 text-xs mr-1"},p(l.name),1))),128))]),e("td",F,[e("button",{onClick:l=>o.editRole(n),class:"text-blue-600 mr-2"},"Edit",8,z),e("button",{onClick:l=>o.deleteRole(n.id),class:"text-red-600"},"Delete",8,O)])]))),128))])]),o.editingRole?(r(),a("div",T,[e("h2",G,"Edit Role: "+p(o.editingRole.name),1),e("form",{onSubmit:w(o.updateRole,["prevent"])},[u(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>o.editingRole.name=n),class:"border p-2 mr-2",required:""},null,512),[[v,o.editingRole.name]]),u(e("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>o.editingRole.label=n),class:"border p-2 mr-2"},null,512),[[v,o.editingRole.label]]),s[8]||(s[8]=e("button",{type:"submit",class:"bg-green-600 text-white px-4 py-2 rounded"},"Save",-1)),e("button",{onClick:s[4]||(s[4]=n=>o.editingRole=null),type:"button",class:"ml-2 px-4 py-2 rounded border"},"Cancel")],32),e("div",H,[s[9]||(s[9]=e("h3",{class:"font-semibold mb-1"},"Assign Permissions",-1)),e("div",null,[(r(!0),a(g,null,y(o.permissions,n=>(r(),a("label",{key:n.id,class:"inline-flex items-center mr-3"},[u(e("input",{type:"checkbox",value:n.id,"onUpdate:modelValue":s[5]||(s[5]=l=>o.editingRolePermissionIds=l),onChange:l=>o.togglePermission(n.id)},null,40,J),[[D,o.editingRolePermissionIds]]),e("span",K,p(n.name),1)]))),128))])])])):U("v-if",!0)])}const Y=j(q,[["render",Q],["__file","/var/www/html/resources/js/Pages/Dashboard/Roles.vue"]]);export{Y as default};
