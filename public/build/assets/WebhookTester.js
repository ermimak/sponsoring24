import{C as y,D as h,f,o as r,w as u,g as t,l as d,y as p,p as i,G as m,v as a,z as k,t as c,a as b}from"./vendor.js";import{D as v}from"./DashboardLayout.js";import{_ as w}from"./_plugin-vue_export-helper.js";import"./SidebarLink.js";import"./NotificationDropdown.js";import"./app.js";/* empty css    */const x=y({components:{DashboardLayout:v},data(){return{eventType:"checkout.session.completed",userId:"",paymentId:"",amount:500,applyDiscount:!1,endpoint:"/webhook/license/stripe",processing:!1,result:null,error:null}},mounted(){this.$page.props.auth&&this.$page.props.auth.user&&(this.userId=this.$page.props.auth.user.id)},methods:{generateRandomId(){const s="test_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);this.paymentId=s},async sendWebhook(){var s,e;this.processing=!0,this.result=null,this.error=null;try{const n=this.createWebhookPayload(),l=await b.post(this.endpoint,n,{headers:{"Content-Type":"application/json","Stripe-Signature":"test_signature"}});this.result=l.data,await this.checkLicenseCreation()}catch(n){console.error("Webhook test error:",n),this.error=((e=(s=n.response)==null?void 0:s.data)==null?void 0:e.error)||n.message||"An unknown error occurred"}finally{this.processing=!1}},createWebhookPayload(){const s=Math.floor(Date.now()/1e3),e=this.applyDiscount?50:0,n=this.amount-e;return this.eventType==="checkout.session.completed"?{id:"evt_"+Math.random().toString(36).substring(2,15),object:"event",api_version:"2020-08-27",created:s,data:{object:{id:"cs_"+Math.random().toString(36).substring(2,15),object:"checkout.session",amount_total:n*100,currency:"chf",customer_email:"test@example.com",payment_intent:this.paymentId||"pi_"+Math.random().toString(36).substring(2,15),payment_status:"paid",metadata:{user_id:this.userId,license_type:"annual",discount_applied:this.applyDiscount?"yes":"no",discount_amount:e}}},type:"checkout.session.completed"}:this.eventType==="payment_intent.succeeded"?{id:"evt_"+Math.random().toString(36).substring(2,15),object:"event",api_version:"2020-08-27",created:s,data:{object:{id:this.paymentId||"pi_"+Math.random().toString(36).substring(2,15),object:"payment_intent",amount:n*100,currency:"chf",payment_method_types:["card"],metadata:{user_id:this.userId,license_type:"annual",discount_applied:this.applyDiscount?"yes":"no",discount_amount:e}}},type:"payment_intent.succeeded"}:{}},async checkLicenseCreation(){try{await new Promise(e=>setTimeout(e,2e3));const s=await b.get("/api/check-license-status");this.result={...this.result,license_check_response:s.data},s.data&&s.data.has_active_license?(this.result.license_created=!0,this.result.license=s.data.license):(this.result.license_created=!1,this.result.message="No active license found")}catch(s){console.error("Error checking license creation:",s),this.result={...this.result,license_created:!1,check_error:s.message}}}}}),_={class:"py-12"},I={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},D={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},S={class:"p-6 bg-white border-b border-gray-200"},T={class:"mb-4"},C={class:"mb-4"},W={class:"mb-4"},M={class:"mb-4"},E={class:"mb-4"},V={class:"flex items-center"},j={class:"mb-4"},U={class:"mb-4"},$=["disabled"],L={key:0},A={key:1},P={key:0,class:"mt-6"},R={class:"bg-gray-100 p-4 rounded-md"},B={class:"text-sm text-gray-800 whitespace-pre-wrap"},N={key:1,class:"mt-6"},F={class:"bg-red-50 border border-red-200 p-4 rounded-md"},G={class:"text-sm text-red-700"};function H(s,e,n,l,z,J){const g=h("DashboardLayout");return r(),f(g,null,{header:u(()=>e[8]||(e[8]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Webhook Tester ",-1)])),default:u(()=>[t("div",_,[t("div",I,[t("div",D,[t("div",S,[e[19]||(e[19]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Stripe Webhook Tester",-1)),e[20]||(e[20]=t("div",{class:"mb-4"},[t("p",{class:"text-gray-600 mb-2"}," This tool allows you to simulate Stripe webhooks for testing purposes. Select an event type and provide the necessary data to send a test webhook to your application. ")],-1)),t("div",T,[e[10]||(e[10]=t("label",{for:"eventType",class:"block text-sm font-medium text-gray-700"},"Event Type",-1)),i(t("select",{id:"eventType","onUpdate:modelValue":e[0]||(e[0]=o=>s.eventType=o),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},e[9]||(e[9]=[t("option",{value:"checkout.session.completed"},"checkout.session.completed",-1),t("option",{value:"payment_intent.succeeded"},"payment_intent.succeeded",-1)]),512),[[m,s.eventType]])]),t("div",C,[e[11]||(e[11]=t("label",{for:"userId",class:"block text-sm font-medium text-gray-700"},"User ID",-1)),i(t("input",{type:"text",id:"userId","onUpdate:modelValue":e[1]||(e[1]=o=>s.userId=o),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter user ID"},null,512),[[a,s.userId]])]),t("div",W,[e[12]||(e[12]=t("label",{for:"paymentId",class:"block text-sm font-medium text-gray-700"},"Payment ID",-1)),i(t("input",{type:"text",id:"paymentId","onUpdate:modelValue":e[2]||(e[2]=o=>s.paymentId=o),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter payment ID or generate random"},null,512),[[a,s.paymentId]]),t("button",{onClick:e[3]||(e[3]=(...o)=>s.generateRandomId&&s.generateRandomId(...o)),class:"mt-2 inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Generate Random ID ")]),t("div",M,[e[13]||(e[13]=t("label",{for:"amount",class:"block text-sm font-medium text-gray-700"},"Amount (CHF)",-1)),i(t("input",{type:"number",id:"amount","onUpdate:modelValue":e[4]||(e[4]=o=>s.amount=o),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter amount in CHF"},null,512),[[a,s.amount]])]),t("div",E,[t("label",V,[i(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=o=>s.applyDiscount=o),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[k,s.applyDiscount]]),e[14]||(e[14]=t("span",{class:"ml-2 text-sm text-gray-600"},"Apply Discount",-1))])]),t("div",j,[e[16]||(e[16]=t("label",{for:"endpoint",class:"block text-sm font-medium text-gray-700"},"Webhook Endpoint",-1)),i(t("select",{id:"endpoint","onUpdate:modelValue":e[6]||(e[6]=o=>s.endpoint=o),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},e[15]||(e[15]=[t("option",{value:"/webhook/license/stripe"},"License Webhook (/webhook/license/stripe)",-1)]),512),[[m,s.endpoint]])]),t("div",U,[t("button",{onClick:e[7]||(e[7]=(...o)=>s.sendWebhook&&s.sendWebhook(...o)),disabled:s.processing,class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:border-indigo-900 focus:ring ring-indigo-300 disabled:opacity-25 transition ease-in-out duration-150"},[s.processing?(r(),d("span",L,"Processing...")):(r(),d("span",A,"Send Test Webhook"))],8,$)]),s.result?(r(),d("div",P,[e[17]||(e[17]=t("h4",{class:"text-md font-medium text-gray-900 mb-2"},"Result",-1)),t("div",R,[t("pre",B,c(JSON.stringify(s.result,null,2)),1)])])):p("",!0),s.error?(r(),d("div",N,[t("div",F,[e[18]||(e[18]=t("h4",{class:"text-md font-medium text-red-800 mb-2"},"Error",-1)),t("p",G,c(s.error),1)])])):p("",!0)])])])])]),_:1})}const ee=w(x,[["render",H]]);export{ee as default};
